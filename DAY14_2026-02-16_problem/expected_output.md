# Expected Output

  ------------------------------------------------------------------------------------------------------------------------
  product_id   warehouse_id   date         opening_stock   closing_stock   total_in   total_out   flag   first_stamp_neg
  ------------ -------------- ------------ --------------- --------------- ---------- ----------- ------ -----------------
  101          1              2026-02-09   0               60              60         0           0      NULL

  101          1              2026-02-10   60              35              100        125         0      NULL

  101          1              2026-02-11   35              35              45         45          0      NULL

  101          1              2026-02-12   35              25              0          10          0      NULL

  101          2              2026-02-11   0               -10             25         35          1      2026-02-11
                                                                                                         17:00:00

  101          2              2026-02-12   -10             0               10         0           1      NULL

  202          1              2026-02-10   0               10              200        190         0      NULL

  202          1              2026-02-12   10              -40             0          50          1      2026-02-12
                                                                                                         14:00:00

  202          2              2026-02-10   0               -5              10         15          1      2026-02-10
                                                                                                         11:00:00

  202          2              2026-02-12   -5              45              50         60          1      2026-02-12
                                                                                                         09:00:00

  303          1              2026-02-10   0               -10             0          10          1      2026-02-10
                                                                                                         09:00:00
  ------------------------------------------------------------------------------------------------------------------------
